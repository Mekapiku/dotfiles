resources:
  - type: command
    script: brew update
<%- homebrew_packages.each do |package| -%>
  - type: homebrew_package
    name: <%= package.name %>
  <%- if package.has_key?(:options) -%>
    options: <%= package.options %>
  <%- end -%>
<%- end -%>
<%- homebrew_cask_package_names.each do |homebrew_cask_package_name| -%>
  - type: homebrew_cask_package
    name: <%= homebrew_cask_package_name %>
<%- end -%>
<%- atom_package.each do |ap| -%>
  - type: atom_package
    name: <%= ap %>
<%- end -%>
  - type: rbenv_ruby
    version: 2.2.2
    global: true
  - type: defaults
    domain: com.apple.dock
    key: autohide
    value: 1
    notify:
      - restart_dock
  - type: defaults
    domain: com.apple.dock
    key: persistent-apps
    value: []
    notify:
      - restart_dock
  - type: defaults
    domain: com.apple.dock
    key: persistent-others
    value: []
    notify:
      - restart_dock
  - type: defaults
    key: com.apple.sound.beep.feedback
    value: 1
  - type: defaults
    key: AppleKeyboardUIMode
    value: 3 # Allow full keyboard access
  - type: git
    repository: https://github.com/programmerMOT/dotfiles.git
    path: /Users/<%= ENV['USER'] %>/dotfiles
    status: updated
    <%- dotfiles_dir.each do |dir| -%>
  - type: command
    script: sudo -u <%= ENV['USER'] %> mkdir <%= dir %>
    <%- end -%>
  <%- dotfiles.each do |path| -%>
  - type: symlink
    destination: /Users/<%= ENV['USER'] %>/dotfiles/linked/<%= path %>
    source: /Users/<%= ENV['USER'] %>/<%= path %>
  <%- end -%>
  - type: command
    check_script: "finger -l | grep -E 'Shell: /bin/zsh$'"
    script: sudo chsh -s /bin/zsh <%= ENV['USER'] %>
  - type: command
    script: sudo -u <%= ENV['USER'] %> touch /Users/<%= ENV['USER'] %>/.z
  - type: command
    script: sudo -u <%= ENV['USER'] %> curl https://raw.githubusercontent.com/Shougo/neobundle.vim/master/bin/install.sh | sh
handlers:
  - id: restart_dock
    type: command
    script: killall Dock
  - id: restart_system_ui_server
    type: command
    script: killall SystemUIServer
